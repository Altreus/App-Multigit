#!/usr/bin/env perl

use strict;
use warnings;
use 5.014;

use App::Multigit qw(mg_each);
use App::Multigit::Script;
use Future;
use curry;

my $future = mg_each(sub {
    my ($repo) = @_;
    $repo->run([ qw(git branch), @ARGV ])
        ->finally($repo->curry::report)
});

my %report = $future->get;

for my $repo (sort keys %report) {
    say for $repo, $report{$repo};
}

sub usage {
<<EOU;
Usage:
    mg branch [argv]

    Runs `git branch argv` on each repository. See `git help branch`.

    With no arguments, therefore, this just lists the branches in each
    repository.
EOU
}
